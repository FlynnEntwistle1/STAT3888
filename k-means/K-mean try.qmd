---
title: "k-means try"
format: html
editor: visual
---

```{r}
load("../data/tech_data.Rdata")
```

```{r}
library(ggplot2)
```

```{r}

# 1. Load data and filter numeric variables
tech_food_numeric <- tech_food[, sapply(tech_food, is.numeric)]

# 2. Remove rows containing NA
tech_food_numeric_clean <- tech_food_numeric[complete.cases(tech_food_numeric), ]

# 3. Remove rows with a value of 0 from all variables
tech_food_numeric_clean <- tech_food_numeric_clean[rowSums(tech_food_numeric_clean == 0) != ncol(tech_food_numeric_clean), ]

# 4. Delete columns with a single value that are meaningless to clustering
tech_food_numeric_clean <- tech_food_numeric_clean[, apply(tech_food_numeric_clean, 2, function(x) length(unique(x)) > 1)]

# 5. Standardized data
scaled_data <- scale(tech_food_numeric_clean)

# 6. Use the Elbow method to select the appropriate number of clusters
wss <- (nrow(scaled_data)-1)*sum(apply(scaled_data, 2, var))
for (i in 2:15) wss[i] <- sum(kmeans(scaled_data, centers=i)$tot.withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")

```

K could be 10
