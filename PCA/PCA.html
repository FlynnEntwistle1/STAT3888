<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pca</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="PCA_files/libs/clipboard/clipboard.min.js"></script>
<script src="PCA_files/libs/quarto-html/quarto.js"></script>
<script src="PCA_files/libs/quarto-html/popper.min.js"></script>
<script src="PCA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PCA_files/libs/quarto-html/anchor.min.js"></script>
<link href="PCA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PCA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PCA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PCA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PCA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="code-for-generating-principal-components-based-on-food-data." class="level1">
<h1>Code for generating principal components, based on food data.</h1>
<blockquote class="blockquote">
<p>Loading in John’s data:</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/tech_data.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creating-dataset" class="level2">
<h2 class="anchored" data-anchor-id="creating-dataset">Creating dataset</h2>
<p>Currently: - Population is all adults over 45 who responded to the survey on BOTH days. - Motivation for this is that metabolism generally decreases with age… probably good to consult the nutrition students, though. - Food codes have been replaced with their actual labels in the data dictionary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fooditems_dict_major <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../data/nutmstatDataItems2019_CSV.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_length</span>(Category.Code) <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"THRDIG"</span> <span class="ot">=</span> <span class="st">"Category.Code"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Category.Label.Major"</span> <span class="ot">=</span> <span class="st">"Category.Label"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>fooditems_dict_minor <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"../data/nutmstatDataItems2019_CSV.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_length</span>(Category.Code) <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"FIVDIG"</span> <span class="ot">=</span> <span class="st">"Category.Code"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Category.Label.Minor"</span> <span class="ot">=</span> <span class="st">"Category.Label"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>both_days_adults_food <span class="ot">&lt;-</span> tech_food <span class="sc">|&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ABSPID) <span class="sc">|&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">y =</span> tech_biom <span class="sc">|&gt;</span> <span class="fu">select</span>(ABSPID, AGEC), <span class="at">by =</span> <span class="st">"ABSPID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(DAYNUM) <span class="sc">==</span> <span class="dv">2</span>, AGEC <span class="sc">&gt;=</span> <span class="dv">45</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fooditems_dict_major, <span class="at">by =</span> <span class="st">"THRDIG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fooditems_dict_minor, <span class="at">by =</span> <span class="st">"FIVDIG"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ABSPID, Category.Label.Major, Category.Label.Minor, GRAMWGT)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(both_days_adults_food, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   ABSPID         Category.Label.Major             Category.Label.Minor  GRAMWGT
   &lt;chr&gt;          &lt;chr&gt;                            &lt;chr&gt;                   &lt;dbl&gt;
 1 NPA11B10000011 Breakfast cereals, ready to eat  Breakfast cereal, wh…   37.8 
 2 NPA11B10000011 Dairy milk (cow, sheep and goat) Milk, cow, fluid, re…  206   
 3 NPA11B10000011 Nuts and nut products            Mixed nuts or nuts a…   17.1 
 4 NPA11B10000011 Tea                              Tea, regular, caffei…  150   
 5 NPA11B10000011 Dairy milk (cow, sheep and goat) Milk, cow, fluid, re…   30.9 
 6 NPA11B10000011 Sugar, honey and syrups          Sugar                    6.64
 7 NPA11B10000011 Tea                              Tea, regular, caffei…  330   
 8 NPA11B10000011 Dairy milk (cow, sheep and goat) Milk, cow, fluid, re…   30.9 
 9 NPA11B10000011 Sugar, honey and syrups          Sugar                    6.64
10 NPA11B10000011 Fruit, nut and seed-bars         Nut and seed based c…   28   </code></pre>
</div>
</div>
<section id="new-splitting-necessary-major-groups-by-minor-groups" class="level3">
<h3 class="anchored" data-anchor-id="new-splitting-necessary-major-groups-by-minor-groups">(NEW) Splitting necessary major groups by minor groups</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>complex_group_splits <span class="ot">&lt;-</span> both_days_adults_food <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category.Label.Major =</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(Category.Label.Major <span class="sc">==</span> <span class="st">"Potatoes"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(Category.Label.Minor <span class="sc">==</span> <span class="st">"Potato products"</span>, <span class="st">"Fried Potatoes and chips"</span>, <span class="st">"Potatoes and potato dishes"</span>), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>           Category.Label.Major)) <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Category.Label.Major =</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(Category.Label.Major <span class="sc">==</span> <span class="st">"Mixed dishes where cereal is the major ingredient"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                  <span class="do">## then</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">case_when</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">str_detect</span>(Category.Label.Minor, <span class="fu">regex</span>(<span class="st">"pizza"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Pizza"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">str_detect</span>(Category.Label.Minor, <span class="fu">regex</span>(<span class="st">"burgers"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Burgers"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">str_detect</span>(Category.Label.Minor, <span class="fu">regex</span>(<span class="st">"sushi"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Sushi"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">str_detect</span>(Category.Label.Minor, <span class="fu">regex</span>(<span class="st">"saturated fat &gt;5 g/100 g"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"High-fat cereal-based takeaway-style food"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># LOW FAT TAKEAWAY: Note: R does not recognise ≤ sign. All higher fat cases captured above.</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">str_detect</span>(Category.Label.Minor, <span class="fu">regex</span>(<span class="st">"5 g/100 g"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span> Category.Label.Minor <span class="sc">==</span> <span class="st">"Other savoury grain dishes"</span> <span class="sc">~</span> <span class="st">"Low-fat cereal-based takeaway-style food"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.default =</span> <span class="st">"Gnocchi and steamed buns"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                  Category.Label.Major</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Category.Label.Minor) <span class="sc">|&gt;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Category.Label"</span> <span class="ot">=</span> <span class="st">"Category.Label.Major"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-servings-measure-based-on-grams" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-servings-measure-based-on-grams">Creating a “servings” measure based on grams</h3>
<p>Looking at the food data, we can create define “1 serving” as the median grams consumed of a particular item.</p>
<p>From here, we just compute servings as (using tea as an example):</p>
<p><span class="math display">\[\text{Servings(Tea)} = \frac{\text{Recorded tea weight (g)}}{\text{Median tea weight (g)}}\]</span></p>
<p>By comparing grams to “servings”, we can directly compare different types of food consumed, without having to worry about how different foods are usually consumed in different weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>both_days_adults_food_servings <span class="ot">&lt;-</span> complex_group_splits <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Category.Label) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">median_grams =</span> <span class="fu">median</span>(GRAMWGT)) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Servings =</span> <span class="fu">ifelse</span>(median_grams <span class="sc">!=</span> <span class="dv">0</span>, GRAMWGT <span class="sc">/</span> median_grams, <span class="dv">0</span>)) <span class="co"># sets to 0 if median grams is 0... avoids any divide by 0 errors.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>both_days_adults_food_servings<span class="sc">$</span>Servings <span class="ot">&lt;-</span> <span class="fu">format</span>(both_days_adults_food_servings<span class="sc">$</span>Servings, <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(both_days_adults_food_servings, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
# Groups:   Category.Label [6]
   ABSPID         Category.Label                   GRAMWGT median_grams Servings
   &lt;chr&gt;          &lt;chr&gt;                              &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;   
 1 NPA11B10000011 Breakfast cereals, ready to eat    37.8          38.5 "   0.9…
 2 NPA11B10000011 Dairy milk (cow, sheep and goat)  206            31.2 "   6.6…
 3 NPA11B10000011 Nuts and nut products              17.1          20   "   0.8…
 4 NPA11B10000011 Tea                               150           220   "   0.6…
 5 NPA11B10000011 Dairy milk (cow, sheep and goat)   30.9          31.2 "   0.9…
 6 NPA11B10000011 Sugar, honey and syrups             6.64          6.3 "   1.0…
 7 NPA11B10000011 Tea                               330           220   "   1.5…
 8 NPA11B10000011 Dairy milk (cow, sheep and goat)   30.9          31.2 "   0.9…
 9 NPA11B10000011 Sugar, honey and syrups             6.64          6.3 "   1.0…
10 NPA11B10000011 Fruit, nut and seed-bars           28            20   "   1.4…</code></pre>
</div>
</div>
<section id="summarising-data-such-that-we-have-one-row-per-individual" class="level4">
<h4 class="anchored" data-anchor-id="summarising-data-such-that-we-have-one-row-per-individual">Summarising data such that we have one row per individual</h4>
<p>Each row is summed servings of food that person consumed over two days.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>wide_adults_food_servings <span class="ot">=</span> both_days_adults_food_servings <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>GRAMWGT, <span class="sc">-</span>median_grams) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Servings =</span> <span class="fu">as.numeric</span>(Servings)) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ABSPID, Category.Label) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Servings =</span> <span class="fu">sum</span>(Servings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Category.Label, <span class="at">values_from =</span> Total_Servings, <span class="at">values_fill =</span> <span class="dv">0</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wide_adults_food_servings, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 121
   ABSPID     `Berry fruit` Breakfast cereals, r…¹ Cheese Chocolate and chocol…²
   &lt;chr&gt;              &lt;dbl&gt;                  &lt;dbl&gt;  &lt;dbl&gt;                  &lt;dbl&gt;
 1 NPA11B100…        0.0273                  2.4    2.21                    1   
 2 NPA11B100…        0                       0      1.12                    0   
 3 NPA11B100…        0                       2.38   0.576                   0.64
 4 NPA11B100…        0.273                   2.34   3.75                    1.4 
 5 NPA11B100…        0                       0      1                       0.68
 6 NPA11B100…        0                       1.77   4                       2.68
 7 NPA11B100…        2.25                    0      4.50                    0   
 8 NPA11B100…        0                       0.909  0.384                   0   
 9 NPA11B100…        0                       0      0.28                    0   
10 NPA11B100…        6.25                    0      0                       0   
# ℹ abbreviated names: ¹​`Breakfast cereals, ready to eat`,
#   ²​`Chocolate and chocolate-based confectionery`
# ℹ 116 more variables: `Coffee and coffee substitutes` &lt;dbl&gt;, Cordials &lt;dbl&gt;,
#   `Dairy milk (cow, sheep and goat)` &lt;dbl&gt;,
#   `Dishes where vegetable is the major component` &lt;dbl&gt;,
#   `Dried fruit, preserved fruit` &lt;dbl&gt;,
#   `Fin fish (excluding commercially sterile)` &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="grouping-food-items-together-with-substantial-overlap" class="level4">
<h4 class="anchored" data-anchor-id="grouping-food-items-together-with-substantial-overlap">Grouping food items together with substantial overlap</h4>
<p>Merging together overlapping food items (columns) aids w factor analysis.</p>
<p><strong>Note:</strong> Ingredients with minimal nutritional content (e.g.&nbsp;baking soda, herbs) and/or low count will be removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>wide_adults_food_servings_foods_grouped <span class="ot">&lt;-</span> wide_adults_food_servings <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Removing variables with minimal nutritional content and/or rare groups, which don't fit in with anything else.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Herbs, spices, seasonings and stock cubes</span><span class="st">`</span>, <span class="co"># this also includes added salt..? Should be careful.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Essences</span><span class="st">`</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Stuffings</span><span class="st">`</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Chemical raising agents and cooking ingredients</span><span class="st">`</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Infant foods</span><span class="st">`</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Infant cereal products</span><span class="st">`</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cheese substitute</span><span class="st">`</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Soy-based ice confection</span><span class="st">`</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dry soup mix</span><span class="st">`</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Soy-based yoghurts</span><span class="st">`</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Formula dietary foods</span><span class="st">`</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Soups</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Soups =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">matches</span>(<span class="st">"Soup"</span>, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(<span class="st">"Soup"</span>), Soups) <span class="sc">|&gt;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fish</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fish and Fish Products</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other sea and freshwater foods</span><span class="st">`</span>, </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Crustacea and molluscs (excluding commercially sterile)</span><span class="st">`</span>, </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fish and seafood products (homemade and takeaway)</span><span class="st">`</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mixed dishes with fish or seafood as the major component</span><span class="st">`</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Packed (commercially sterile) fish and seafood</span><span class="st">`</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fin fish (excluding commercially sterile)</span><span class="st">`</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    )), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other sea and freshwater foods</span><span class="st">`</span>, </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Crustacea and molluscs (excluding commercially sterile)</span><span class="st">`</span>, </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fish and seafood products (homemade and takeaway)</span><span class="st">`</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mixed dishes with fish or seafood as the major component</span><span class="st">`</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Packed (commercially sterile) fish and seafood</span><span class="st">`</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fin fish (excluding commercially sterile)</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fruit</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fresh Fruit and Fruit-based Dishes</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Berry fruit</span><span class="st">`</span>, </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Stone fruit</span><span class="st">`</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Citrus fruit</span><span class="st">`</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other fruit</span><span class="st">`</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Pome fruit</span><span class="st">`</span>,</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Tropical and subtropical fruit</span><span class="st">`</span>,</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mixtures of two or more groups of fruit</span><span class="st">`</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    )))) <span class="sc">|&gt;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Berry fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Stone fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Citrus fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Other fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Pome fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Tropical and subtropical fruit</span><span class="st">`</span>, <span class="sc">-</span><span class="st">`</span><span class="at">Mixtures of two or more groups of fruit</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fruit and muesli bars</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fruit and Muesli-style bars</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Fruit, nut and seed-bars</span><span class="st">`</span>,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Muesli or cereal style bars</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Fruit, nut and seed-bars</span><span class="st">`</span>, </span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Muesli or cereal style bars</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cordials and soft drink</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Soft drinks, Cordials, Sports drinks, and Milkshakes</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Soft drinks, and flavoured mineral waters</span><span class="st">`</span>, </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cordials</span><span class="st">`</span>, </span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Flavoured milks and milkshakes</span><span class="st">`</span>, </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Electrolyte, energy and fortified drinks</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Soft drinks, and flavoured mineral waters</span><span class="st">`</span>, </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Cordials</span><span class="st">`</span>, </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Flavoured milks and milkshakes</span><span class="st">`</span>, </span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Electrolyte, energy and fortified drinks</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Desserts</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Milk-based and other dessert items</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other dishes where milk or a milk product is the major component</span><span class="st">`</span>, </span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sweet biscuits</span><span class="st">`</span>, </span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Frozen milk products</span><span class="st">`</span>, </span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dishes and products other than confectionery where sugar is the major component</span><span class="st">`</span>, </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Custards</span><span class="st">`</span>,</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Batter-based products</span><span class="st">`</span>,</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mixed dishes where fruit is the major component</span><span class="st">`</span>,</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cakes, muffins, scones, cake-type desserts</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Other dishes where milk or a milk product is the major component</span><span class="st">`</span>, </span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Sweet biscuits</span><span class="st">`</span>, </span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Frozen milk products</span><span class="st">`</span>, </span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Dishes and products other than confectionery where sugar is the major component</span><span class="st">`</span>,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mixed dishes where fruit is the major component</span><span class="st">`</span>,</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Custards</span><span class="st">`</span>, <span class="st">`</span><span class="at">Batter-based products</span><span class="st">`</span>, <span class="st">`</span><span class="at">Cakes, muffins, scones, cake-type desserts</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Chocolate and lollies</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Chocolate and lollies</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Chocolate and chocolate-based confectionery</span><span class="st">`</span>, </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other confectionery</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Chocolate and chocolate-based confectionery</span><span class="st">`</span>, </span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Other confectionery</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Butters, margarines, and oils</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Butters, margarines, and oils</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Butters</span><span class="st">`</span>,</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Margarine and table spreads</span><span class="st">`</span>, </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Plant oils</span><span class="st">`</span>,</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Unspecified fats</span><span class="st">`</span>,</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dairy blends</span><span class="st">`</span>,</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other fats</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Butters</span><span class="st">`</span>, <span class="st">`</span><span class="at">Margarine and table spreads</span><span class="st">`</span>, <span class="st">`</span><span class="at">Plant oils</span><span class="st">`</span>, <span class="st">`</span><span class="at">Unspecified fats</span><span class="st">`</span>, <span class="st">`</span><span class="at">Dairy blends</span><span class="st">`</span>, <span class="st">`</span><span class="at">Other fats</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sauces</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Sauces</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Gravies and savoury sauces</span><span class="st">`</span>, <span class="st">`</span><span class="at">Salad dressings</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Gravies and savoury sauces</span><span class="st">`</span>, <span class="st">`</span><span class="at">Salad dressings</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coffee and Tea</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Coffee and Tea</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">Coffee and coffee substitutes</span><span class="st">`</span>, <span class="st">`</span><span class="at">Tea</span><span class="st">`</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">Coffee and coffee substitutes</span><span class="st">`</span>, <span class="st">`</span><span class="at">Tea</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Starchy snacks</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Starchy snacks</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Extruded or reformed snacks</span><span class="st">`</span>,</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other snacks</span><span class="st">`</span>,</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Corn snacks</span><span class="st">`</span>,</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Potato snacks</span><span class="st">`</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>    )))) <span class="sc">|&gt;</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Extruded or reformed snacks</span><span class="st">`</span>,</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other snacks</span><span class="st">`</span>,</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Corn snacks</span><span class="st">`</span>,</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Potato snacks</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Alcohol</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Alcohol</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Wines</span><span class="st">`</span>,</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beers</span><span class="st">`</span>,</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Spirits</span><span class="st">`</span>,</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cider and perry</span><span class="st">`</span>,</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other alcoholic beverages</span><span class="st">`</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Wines</span><span class="st">`</span>,</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beers</span><span class="st">`</span>,</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Spirits</span><span class="st">`</span>,</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cider and perry</span><span class="st">`</span>,</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Other alcoholic beverages</span><span class="st">`</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Legumes</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Legumes and pulses</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Peas and beans</span><span class="st">`</span>,</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mature legumes and pulses</span><span class="st">`</span>,</span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mature legume and pulse products and dishes</span><span class="st">`</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Peas and beans</span><span class="st">`</span>,</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mature legumes and pulses</span><span class="st">`</span>,</span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mature legume and pulse products and dishes</span><span class="st">`</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Breakfast cereal and porridge</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Breakfast cereal and porridge</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Breakfast cereals, ready to eat</span><span class="st">`</span>,</span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Breakfast cereals, hot porridge style</span><span class="st">`</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Breakfast cereals, ready to eat</span><span class="st">`</span>,</span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Breakfast cereals, hot porridge style</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cheese, yogurts</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Cheese, yogurt, cream</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cheese</span><span class="st">`</span>,</span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Yoghurt</span><span class="st">`</span>,</span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cream</span><span class="st">`</span></span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cheese</span><span class="st">`</span>,</span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Yoghurt</span><span class="st">`</span>,</span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cream</span><span class="st">`</span></span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Processed meat</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Processed meats</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Processed meat</span><span class="st">`</span>,</span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sausages, frankfurts and saveloys</span><span class="st">`</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Processed meat</span><span class="st">`</span>,</span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Sausages, frankfurts and saveloys</span><span class="st">`</span></span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Red meat, unprocessed</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Red meat, unprocessed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beef, sheep and pork, unprocessed</span><span class="st">`</span>,</span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mammalian game meats</span><span class="st">`</span>,</span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Beef, sheep and pork, unprocessed</span><span class="st">`</span>,</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Mammalian game meats</span><span class="st">`</span>,</span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Eggs and egg dishes</span></span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Eggs and egg dishes</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Eggs</span><span class="st">`</span>,</span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dishes where egg is the major ingredient</span><span class="st">`</span>,</span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a>  )))) <span class="sc">|&gt;</span></span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Eggs</span><span class="st">`</span>,</span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Dishes where egg is the major ingredient</span><span class="st">`</span>,</span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a><span class="co"># This is actually quite annoying... `mixed dishes where cereal is main component` includes sandwiches, sushi, pizza, etc... </span></span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a><span class="do">## Testing</span></span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wide_adults_food_servings_foods_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ABSPID"                                                                               
 [2] "Dairy milk (cow, sheep and goat)"                                                     
 [3] "Dishes where vegetable is the major component"                                        
 [4] "Dried fruit, preserved fruit"                                                         
 [5] "Flours and other cereal grains and starches"                                          
 [6] "Fruit and vegetable juices, and drinks"                                               
 [7] "Leaf and stalk vegetables"                                                            
 [8] "Low-fat cereal-based takeaway-style food"                                             
 [9] "Mixed dishes where poultry or feathered game is the major component"                  
[10] "Nuts and nut products"                                                                
[11] "Pickles, chutneys and relishes"                                                       
[12] "Potatoes and potato dishes"                                                           
[13] "Regular breads, and bread rolls (plain/unfilled/untopped varieties)"                  
[14] "Sugar, honey and syrups"                                                              
[15] "Waters, municipal and bottled, unflavoured"                                           
[16] "Pizza"                                                                                
[17] "Poultry and feathered game"                                                           
[18] "Cabbage, cauliflower and similar brassica vegetables"                                 
[19] "Carrot and similar root vegetables"                                                   
[20] "Pastries"                                                                             
[21] "Savoury biscuits"                                                                     
[22] "Other fruiting vegetables"                                                            
[23] "Other vegetables and vegetable combinations"                                          
[24] "Jam and lemon spreads, chocolate spreads, sauces"                                     
[25] "Tomato and tomato products"                                                           
[26] "Yeast, and yeast vegetable or meat extracts"                                          
[27] "Mixed dishes where beef, sheep, pork or mammalian game is the major component"        
[28] "Pasta and pasta products (without sauce)"                                             
[29] "Burgers"                                                                              
[30] "Dips"                                                                                 
[31] "English-style muffins, flat breads, and savoury and sweet breads"                     
[32] "Dairy milk substitutes, unflavoured"                                                  
[33] "Other beverage flavourings and prepared beverages"                                    
[34] "Fried Potatoes and chips"                                                             
[35] "Intense sweetening agents"                                                            
[36] "Organ meats and offal, products and dishes"                                           
[37] "Seeds and seed products"                                                              
[38] "Sushi"                                                                                
[39] "High-fat cereal-based takeaway-style food"                                            
[40] "Meat substitutes"                                                                     
[41] "Dishes where meat substitutes are the major component"                                
[42] "Mixed dishes where sausage, bacon, ham or other processed meat is the major component"
[43] "Gnocchi and steamed buns"                                                             
[44] "Soups"                                                                                
[45] "Fish and Fish Products"                                                               
[46] "Fresh Fruit and Fruit-based Dishes"                                                   
[47] "Fruit and Muesli-style bars"                                                          
[48] "Soft drinks, Cordials, Sports drinks, and Milkshakes"                                 
[49] "Milk-based and other dessert items"                                                   
[50] "Chocolate and lollies"                                                                
[51] "Butters, margarines, and oils"                                                        
[52] "Sauces"                                                                               
[53] "Coffee and Tea"                                                                       
[54] "Starchy snacks"                                                                       
[55] "Alcohol"                                                                              
[56] "Legumes and pulses"                                                                   
[57] "Breakfast cereal and porridge"                                                        
[58] "Cheese, yogurt, cream"                                                                
[59] "Processed meats"                                                                      
[60] "Red meat, unprocessed"                                                                
[61] "Eggs and egg dishes"                                                                  </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Results of variable merging (so far).</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(wide_adults_food_servings_foods_grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ABSPID"                                                                               
 [2] "Dairy milk (cow, sheep and goat)"                                                     
 [3] "Dishes where vegetable is the major component"                                        
 [4] "Dried fruit, preserved fruit"                                                         
 [5] "Flours and other cereal grains and starches"                                          
 [6] "Fruit and vegetable juices, and drinks"                                               
 [7] "Leaf and stalk vegetables"                                                            
 [8] "Low-fat cereal-based takeaway-style food"                                             
 [9] "Mixed dishes where poultry or feathered game is the major component"                  
[10] "Nuts and nut products"                                                                
[11] "Pickles, chutneys and relishes"                                                       
[12] "Potatoes and potato dishes"                                                           
[13] "Regular breads, and bread rolls (plain/unfilled/untopped varieties)"                  
[14] "Sugar, honey and syrups"                                                              
[15] "Waters, municipal and bottled, unflavoured"                                           
[16] "Pizza"                                                                                
[17] "Poultry and feathered game"                                                           
[18] "Cabbage, cauliflower and similar brassica vegetables"                                 
[19] "Carrot and similar root vegetables"                                                   
[20] "Pastries"                                                                             
[21] "Savoury biscuits"                                                                     
[22] "Other fruiting vegetables"                                                            
[23] "Other vegetables and vegetable combinations"                                          
[24] "Jam and lemon spreads, chocolate spreads, sauces"                                     
[25] "Tomato and tomato products"                                                           
[26] "Yeast, and yeast vegetable or meat extracts"                                          
[27] "Mixed dishes where beef, sheep, pork or mammalian game is the major component"        
[28] "Pasta and pasta products (without sauce)"                                             
[29] "Burgers"                                                                              
[30] "Dips"                                                                                 
[31] "English-style muffins, flat breads, and savoury and sweet breads"                     
[32] "Dairy milk substitutes, unflavoured"                                                  
[33] "Other beverage flavourings and prepared beverages"                                    
[34] "Fried Potatoes and chips"                                                             
[35] "Intense sweetening agents"                                                            
[36] "Organ meats and offal, products and dishes"                                           
[37] "Seeds and seed products"                                                              
[38] "Sushi"                                                                                
[39] "High-fat cereal-based takeaway-style food"                                            
[40] "Meat substitutes"                                                                     
[41] "Dishes where meat substitutes are the major component"                                
[42] "Mixed dishes where sausage, bacon, ham or other processed meat is the major component"
[43] "Gnocchi and steamed buns"                                                             
[44] "Soups"                                                                                
[45] "Fish and Fish Products"                                                               
[46] "Fresh Fruit and Fruit-based Dishes"                                                   
[47] "Fruit and Muesli-style bars"                                                          
[48] "Soft drinks, Cordials, Sports drinks, and Milkshakes"                                 
[49] "Milk-based and other dessert items"                                                   
[50] "Chocolate and lollies"                                                                
[51] "Butters, margarines, and oils"                                                        
[52] "Sauces"                                                                               
[53] "Coffee and Tea"                                                                       
[54] "Starchy snacks"                                                                       
[55] "Alcohol"                                                                              
[56] "Legumes and pulses"                                                                   
[57] "Breakfast cereal and porridge"                                                        
[58] "Cheese, yogurt, cream"                                                                
[59] "Processed meats"                                                                      
[60] "Red meat, unprocessed"                                                                
[61] "Eggs and egg dishes"                                                                  </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(wide_adults_food_servings_foods_grouped <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>ABSPID), <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                           PC1     PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     1.50182 1.43322 1.29852 1.24851 1.18544 1.16899 1.14658
Proportion of Variance 0.03759 0.03424 0.02810 0.02598 0.02342 0.02278 0.02191
Cumulative Proportion  0.03759 0.07183 0.09993 0.12591 0.14933 0.17211 0.19402
                           PC8     PC9    PC10    PC11    PC12   PC13    PC14
Standard deviation     1.12589 1.11955 1.10834 1.09377 1.08267 1.0734 1.06866
Proportion of Variance 0.02113 0.02089 0.02047 0.01994 0.01954 0.0192 0.01903
Cumulative Proportion  0.21514 0.23603 0.25651 0.27645 0.29598 0.3152 0.33422
                          PC15    PC16    PC17    PC18    PC19    PC20   PC21
Standard deviation     1.06253 1.05311 1.04712 1.04589 1.04065 1.03773 1.0248
Proportion of Variance 0.01882 0.01848 0.01827 0.01823 0.01805 0.01795 0.0175
Cumulative Proportion  0.35304 0.37152 0.38980 0.40803 0.42608 0.44402 0.4615
                          PC22   PC23    PC24    PC25    PC26    PC27    PC28
Standard deviation     1.01742 1.0159 1.01034 1.00854 1.00631 0.99763 0.99024
Proportion of Variance 0.01725 0.0172 0.01701 0.01695 0.01688 0.01659 0.01634
Cumulative Proportion  0.47878 0.4960 0.51299 0.52994 0.54682 0.56341 0.57975
                          PC29    PC30   PC31    PC32   PC33    PC34    PC35
Standard deviation     0.98749 0.98316 0.9798 0.97459 0.9676 0.96622 0.96207
Proportion of Variance 0.01625 0.01611 0.0160 0.01583 0.0156 0.01556 0.01543
Cumulative Proportion  0.59601 0.61212 0.6281 0.64395 0.6595 0.67511 0.69054
                         PC36    PC37    PC38    PC39    PC40    PC41    PC42
Standard deviation     0.9549 0.94763 0.94022 0.93716 0.92686 0.91937 0.91699
Proportion of Variance 0.0152 0.01497 0.01473 0.01464 0.01432 0.01409 0.01401
Cumulative Proportion  0.7057 0.72070 0.73543 0.75007 0.76439 0.77848 0.79249
                          PC43    PC44    PC45    PC46    PC47    PC48   PC49
Standard deviation     0.91025 0.90591 0.89278 0.88682 0.88180 0.87066 0.8661
Proportion of Variance 0.01381 0.01368 0.01328 0.01311 0.01296 0.01263 0.0125
Cumulative Proportion  0.80630 0.81998 0.83326 0.84637 0.85933 0.87196 0.8845
                          PC50    PC51    PC52   PC53   PC54    PC55    PC56
Standard deviation     0.85857 0.84567 0.84059 0.8233 0.8162 0.80524 0.79668
Proportion of Variance 0.01229 0.01192 0.01178 0.0113 0.0111 0.01081 0.01058
Cumulative Proportion  0.89675 0.90867 0.92045 0.9317 0.9428 0.95365 0.96423
                         PC57    PC58    PC59   PC60
Standard deviation     0.7824 0.74656 0.70449 0.6929
Proportion of Variance 0.0102 0.00929 0.00827 0.0080
Cumulative Proportion  0.9744 0.98373 0.99200 1.0000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is what is used in regression.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pca_scores <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>x</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># loadings (contributions of each variable to the components)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>pca_loadings <span class="ot">&lt;-</span> pca_result<span class="sc">$</span>rotation</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the variance explained by each principal component</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_result, <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PCA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There’s approx. 4 PC’s with eigenvalue &gt; 1.5.</p>
<section id="saving-pca-and-food-serving-data" class="level4">
<h4 class="anchored" data-anchor-id="saving-pca-and-food-serving-data">Saving PCA and food serving data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(pca_result, <span class="at">file =</span> <span class="st">"PCA_results.RData"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(wide_adults_food_servings_foods_grouped,<span class="at">file =</span> <span class="st">"wide_adults_food_servings_foods_grouped.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>